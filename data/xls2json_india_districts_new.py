#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
Convert the WashWatch spreadsheet into our JSON format

Usage:
    xls2json.py [--verbose] <xlsPercentFile> <xlsAbsoluteFile>
    xls2json.py (-h | --help)

Options:
    -h --help       Show this screen
    -v --verbose    Output verbose javascript
"""

# script to read in Excel spreadsheet and spit out the json format we
# need

from __future__ import unicode_literals

pfile = "mapdata_india_sanitation_districts_2.xlsx"
        #mapdata_india_sanitation_states_new3.xlsx"
afile = "mapdata3.xlsx"

import json
import sys

from docopt import docopt
import xlrd

# The below maps the state / district names to codes that match what's in the map file
NAME_CODE = {
"Nicobars":"IN.AN.NI",
"North And Middle Andaman":"",
"South Andamans":"",
"Adilabad":"IN.AP.AD",
"Anantapur":"IN.AP.AN",
"Chittoor":"IN.AP.CH",
"Cuddapah":"IN.AP.CU",
"East Godavari":"IN.AP.EG",
"Guntur":"IN.AP.GU",
"":"IN.AP.HY",
"Karimnagar":"IN.AP.KA",
"Khammam":"IN.AP.KH",
"Krishna":"IN.AP.KR",
"Kurnool":"IN.AP.KU",
"Mahbubnagar":"IN.AP.MA",
"Medak":"IN.AP.ME",
"Nalgonda":"IN.AP.NA",
"Nellore":"IN.AP.NE",
"Nizamabad":"IN.AP.NI",
"Prakasam":"IN.AP.PR",
"Rangareddi":"IN.AP.RA",
"Srikakulam":"IN.AP.SR",
"Visakhapatnam":"IN.AP.VS",
"Vizianagaram":"IN.AP.VZ",
"Warangal":"IN.AP.WA",
"West Godavari":"IN.AP.WG",
"Anjaw":"",
"Changlang":"IN.AR.CH",
"Dibang Valley":"0",
"East Kameng":"IN.AR.EK",
"East Siang":"IN.AR.ES",
"Kurung Kumey":"0",
"Lohit":"IN.AR.LO",
"Lower Dibang Valley":"0",
"Lower Subansiri":"IN.AR.LB",
"Papum Pare":"IN.AR.PA",
"Tawang":"IN.AR.TA",
"Tirap":"IN.AR.TI",
"Upper Siang":"IN.AR.US",
"Upper Subansiri":"IN.AR.UB",
"West Kameng":"IN.AR.WK",
"West Siang":"IN.AR.WS",
"Bagsha":"",
"Barpeta":"IN.AS.BA",
"Bongaigaon":"IN.AS.BO",
"Cachar":"IN.AS.CA",
"Chirang":"",
"Darrang":"IN.AS.DA",
"Dhemaji":"IN.AS.DM",
"Dhubri":"IN.AS.DB",
"Dibrugarh":"IN.AS.DI",
"Goalpara":"IN.AS.GP",
"Golaghat":"IN.AS.GG",
"Hailakandi":"IN.AS.HA",
"Jorhat":"IN.AS.JO",
"Kamrup":"IN.AS.KP",
"":"",
"Karbi Anglong":"IN.AS.KA",
"Karimganj":"IN.AS.KR",
"Kokrajhar":"IN.AS.KK",
"Lakhimpur":"IN.AS.LA",
"Marigaon":"IN.AS.MA",
"Nagaon":"IN.AS.NG",
"Nalbari":"IN.AS.NL",
"":"IN.AS.NC",
"Sibsagar":"IN.AS.SI",
"Sonitpur":"IN.AS.SO",
"Tinsukia":"IN.AS.TI",
"Udalguri":"",
"Araria":"IN.BR.AR",
"Arwal":"",
"Aurangabad":"IN.BR.AU",
"Banka":"IN.BR.BA",
"Begusarai":"IN.BR.BE",
"Bhagalpur":"IN.BR.BG",
"Bhojpur":"IN.BR.BJ",
"Buxar":"IN.BR.BU",
"Darbhanga":"IN.BR.DA",
"Gaya":"IN.BR.GA",
"Gopalganj":"IN.BR.GO",
"Jamui":"IN.BR.JA",
"Jehanabad":"IN.BR.JE",
"Kaimur(Bhabua)":"IN.BR.KM",
"Katihar":"IN.BR.KT",
"Khagaria":"IN.BR.KH",
"Kishanganj":"IN.BR.KI",
"Lakhisarai":"IN.BR.LA",
"Madhepura":"IN.BR.MP",
"Madhubani":"IN.BR.MB",
"Munger":"IN.BR.MG",
"Muzaffarpur":"IN.BR.MZ",
"Nalanda":"IN.BR.NL",
"Nawada":"IN.BR.NW",
"Pashchim Champaran":"IN.BR.WC",
"Patna":"IN.BR.PA",
"Purba Champaran":"IN.BR.EC",
"Purnia":"IN.BR.PU",
"Sasaram(Rohtas)":"IN.BR.RO",
"Saharsa":"IN.BR.SH",
"Samastipur":"IN.BR.SM",
"Saran":"IN.BR.SR",
"Sheikhpura":"IN.BR.SP",
"Sheohar":"IN.BR.SO",
"Sitamarhi":"IN.BR.ST",
"Siwan":"IN.BR.SW",
"Supaul":"IN.BR.SU",
"Vaishali":"IN.BR.VA",
"":"IN.CH.CH",
"Bastar(Jagdalpur)":"IN.CT.BA",
"":"IN.KA.BJ",
"Bilaspur":"IN.CT.BI",
"Dantewada":"IN.CT.DA",
"Dhamtari":"IN.CT.DH",
"Durg":"IN.CT.DU",
"Janjgir - Champa":"IN.CT.JC",
"Jashpur":"IN.CT.JA",
"Kanker":"IN.CT.KK",
"Kawardha(Kabirdham)":"IN.CT.KW",
"Korba":"IN.CT.KB",
"Koriya":"IN.CT.KJ",
"Mahasamund":"IN.CT.MA",
"":"",
"Raigarh":"IN.CT.RG",
"Raipur":"IN.CT.RP",
"Rajnandgaon":"IN.CT.RN",
"Surguja":"IN.CT.SU",
"":"IN.DN.DN",
"":"IN.DD.DA",
"":"",
"":"",
"":"",
"":"",
"":"",
"":"",
"":"",
"":"",
"":"",
"":"",
"North Goa":"IN.GA.NG",
"South Goa":"IN.GA.SG",
"Ahmedabad":"IN.GJ.AH",
"Amreli":"IN.GJ.AM",
"Anand":"IN.GJ.AN",
"Banas Kantha":"IN.GJ.BK",
"Bharuch":"IN.GJ.BR",
"Bhavnagar":"IN.GJ.BV",
"Dahod":"IN.GJ.DA",
"Gandhinagar":"IN.GJ.GA",
"Jamnagar":"IN.GJ.JA",
"Junagadh":"IN.GJ.JU",
"Kachchh":"IN.GJ.KA",
"Kheda":"IN.GJ.KH",
"Mahesana":"IN.GJ.MA",
"Narmada":"IN.GJ.NR",
"Navsari":"IN.GJ.NV",
"Panch Mahals":"IN.GJ.PM",
"Patan":"IN.GJ.PA",
"Porbandar":"IN.GJ.PO",
"Rajkot":"IN.GJ.RA",
"Sabar Kantha":"IN.GJ.SK",
"Surat":"IN.GJ.ST",
"Surendranagar":"IN.GJ.SN",
"Tapi":"",
"Dangs":"IN.GJ.DG",
"Vadodara":"IN.GJ.VD",
"Valsad":"IN.GJ.VL",
"Ambala":"IN.HR.AM",
"Bhiwani":"IN.HR.BH",
"Faridabad":"IN.HR.FR",
"Fatehabad":"IN.HR.FT",
"Gurgaon":"IN.HR.GU",
"Hisar":"IN.HR.HI",
"Jhajjar":"IN.HR.JH",
"Jind":"IN.HR.JI",
"Kaithal":"IN.HR.KT",
"Karnal":"IN.HR.KR",
"Kurukshetra":"IN.HR.KU",
"Mahendragarh":"IN.HR.MA",
"Mewat":"",
"":"",
"Panchkula":"IN.HR.PK",
"Panipat":"IN.HR.PP",
"Rewari":"IN.HR.RE",
"Rohtak":"IN.HR.RO",
"Sirsa":"IN.HR.SI",
"Sonipat":"IN.HR.SO",
"Yamunanagar":"IN.HR.YN",
"Bilaspur":"IN.CT.BI",
"Chamba":"IN.HP.CH",
"Hamirpur":"IN.HP.HA",
"Kangra":"IN.HP.KA",
"Kinnaur":"IN.HP.KI",
"Kullu":"IN.HP.KU",
"Lahaul & Spiti":"IN.HP.LS",
"Mandi":"IN.HP.MA",
"Shimla":"IN.HP.SH",
"Sirmaur":"IN.HP.SI",
"Solan":"IN.HP.SO",
"Una":"IN.HP.UN",
"Anantnag":"IN.JK.AN",
"Budgam":"IN.JK.BD",
"Bandipora":"",
"Baramulla":"IN.JK.BR",
"Doda":"IN.JK.DO",
"Ganderbal":"",
"Jammu":"IN.JK.JA",
"Kargil":"IN.JK.KR",
"Kathua":"IN.JK.KT",
"Kishtwar":"",
"Kulgam":"",
"Kupwara":"IN.JK.KU",
"Leh (Ladakh)":"IN.JK.LE",
"Pulwama":"IN.JK.PU",
"Poonch":"IN.JK.PO",
"Rajauri":"IN.JK.RA",
"Ramban":"",
"Reasi":"",
"Samba":"",
"Shopian":"",
"Srinagar":"IN.JK.SR",
"Udhampur":"IN.JK.UD",
"Bokaro":"IN.JH.BO",
"Chatra":"IN.JH.CH",
"Deoghar":"IN.JH.DE",
"Dhanbad":"IN.JH.DH",
"Dumka":"IN.JH.DU",
"Garhwa":"IN.JH.GA",
"Giridih":"IN.JH.GI",
"Godda":"IN.JH.GO",
"Gumla":"IN.JH.GU",
"Hazaribagh":"IN.JH.HA",
"Jamtara":"0",
"Khunti":"",
"Koderma":"IN.JH.KO",
"Latehar":"0",
"Lohardaga":"IN.JH.LO",
"Pakur":"IN.JH.PK",
"Palamu":"IN.JH.PL",
"Paschim Singhbhum":"IN.JH.WS",
"Purbi Singhbhum":"IN.JH.ES",
"Ramgarh":"",
"Ranchi":"IN.JH.RA",
"Sahibganj":"IN.JH.SA",
"Seraikela Kharsawan":"0",
"Simdega":"0",
"Bagalkot":"IN.KA.BK",
"Bangalore Urban":"IN.KA.BN",
"Bangalore Rural":"IN.KA.BR",
"Belgaum":"IN.KA.BG",
"Bellary":"IN.KA.BL",
"Bidar":"IN.KA.BD",
"Bijapur":"IN.KA.BJ",
"Chamarajanagar":"IN.KA.CJ",
"Chickmagalur":"",
"Chikballapur":"IN.KA.CK",
"Chitradurga":"IN.KA.CT",
"Mangalore(Dakshina Kannada)":"IN.KA.DK",
"Davangere":"IN.KA.DA",
"Dharwad":"IN.KA.DH",
"Gadag":"IN.KA.GA",
"Gulbarga":"IN.KA.GU",
"Hassan":"IN.KA.HS",
"Haveri":"IN.KA.HV",
"Kodagu":"IN.KA.KD",
"Kolar":"IN.KA.KL",
"Koppal":"IN.KA.KP",
"Mandya":"IN.KA.MA",
"Mysore":"IN.KA.MY",
"Raichur":"IN.KA.RA",
"Ramanagara":"",
"Shimoga":"IN.KA.SH",
"Tumkur":"IN.KA.TU",
"Udupi":"IN.KA.UD",
"Uttar Kannada":"IN.KA.UK",
"":"",
"Alappuzha":"IN.KL.AL",
"Ernakulam":"IN.KL.ER",
"Idukki":"IN.KL.ID",
"Kannur":"IN.KL.KN",
"Kasargod":"IN.KL.KS",
"Kollam":"IN.KL.KL",
"Kottayam":"IN.KL.KT",
"Kozhikode":"IN.KL.KZ",
"Malappuram":"IN.KL.MA",
"Palakkad":"IN.KL.PL",
"Pathanamthitta":"IN.KL.PT",
"Thiruvananthapuram":"IN.KL.TV",
"Thrissur":"IN.KL.TS",
"Wayanad":"IN.KL.WA",
"":"",
"Alirajpur":"",
"Anuppur":"IN.MP.SH",
"Ashoknagar":"0",
"Balaghat":"IN.MP.BL",
"Barwani":"IN.MP.BR",
"Betul":"IN.MP.BE",
"Bhind":"IN.MP.BD",
"Bhopal":"IN.MP.BP",
"Burhanpur":"0",
"Chhatarpur":"IN.MP.CT",
"Chhindwara":"IN.MP.CN",
"Damoh":"IN.MP.DM",
"Datia":"IN.MP.DT",
"Dewas":"IN.MP.DE",
"Dhar":"IN.MP.DH",
"Dindori":"IN.MP.DI",
"Khandwa(East Nimar)":"IN.MP.EN",
"Guna":"IN.MP.GU",
"Gwalior":"IN.MP.GW",
"Harda":"IN.MP.HA",
"Hoshangabad":"IN.MP.HO",
"Indore":"IN.MP.IN",
"Jabalpur":"IN.MP.JA",
"Jhabua":"IN.MP.JH",
"Katni":"IN.MP.KA",
"Mandla":"IN.MP.ML",
"Mandsaur":"IN.MP.MS",
"Morena":"IN.MP.MO",
"Narsinghpur":"IN.MP.NA",
"Neemuch":"IN.MP.NE",
"Panna":"IN.MP.PA",
"Raisen":"IN.MP.RS",
"Rajgarh":"IN.MP.RG",
"Ratlam":"IN.MP.RL",
"Rewa":"IN.MP.RE",
"Sagar":"IN.MP.SG",
"Satna":"IN.MP.ST",
"Sehore":"IN.MP.SR",
"Seoni":"IN.MP.SO",
"Shahdol":"IN.MP.SH",
"Shajapur":"IN.MP.SJ",
"Sheopur":"IN.MP.SP",
"Shivpuri":"IN.MP.SV",
"Sidhi":"IN.MP.SI",
"Singrauli":"",
"Tikamgarh":"IN.MP.TI",
"Ujjain":"IN.MP.UJ",
"Umaria":"IN.MP.UM",
"Vidisha":"IN.MP.VI",
"Khargone":"IN.MP.WN",
"Ahmednagar":"IN.MH.AH",
"Akola":"IN.MH.AK",
"Amravati":"IN.MH.AM",
"Aurangabad":"IN.BR.AU",
"Bhandara":"IN.MH.BH",
"Beed":"IN.MH.BI",
"Buldhana":"IN.MH.BU",
"Chandrapur":"IN.MH.CH",
"Dhule":"IN.MH.DH",
"Gadchiroli":"IN.MH.GA",
"Gondia":"IN.MH.GO",
"Hingoli":"IN.MH.HI",
"Jalgaon":"IN.MH.JG",
"Jalna":"IN.MH.JN",
"Kolhapur":"IN.MH.KO",
"Latur":"IN.MH.LA",
"":"",
"":"IN.MH.MC",
"Nagpur":"IN.MH.NG",
"Nanded":"IN.MH.ND",
"Nandurbar":"IN.MH.NB",
"Nashik":"IN.MH.NS",
"Osmanabad":"IN.MH.OS",
"Parbhani":"IN.MH.PA",
"Pune":"IN.MH.PU",
"Raigad":"IN.CT.RG",
"Ratnagiri":"IN.MH.RT",
"Sangli":"IN.MH.SN",
"Satara":"IN.MH.ST",
"Sindhudurg":"IN.MH.SI",
"Solapur":"IN.MH.SO",
"Thane":"IN.MH.TH",
"Wardha":"IN.MH.WR",
"Washim":"IN.MH.WS",
"Yavatmal":"IN.MH.YA",
"Bishnupur":"IN.MN.BI",
"Chandel":"IN.MN.CD",
"Churachandpur":"IN.MN.CC",
"Imphal East":"IN.MN.EI",
"Imphal West":"IN.MN.WI",
"Senapati":"IN.MN.SE",
"Tamenglong":"IN.MN.TA",
"Thoubal":"IN.MN.TH",
"Ukhrul":"IN.MN.UK",
"East Garo Hills":"IN.ML.EG",
"East Khasi Hills":"IN.ML.EK",
"Jaintia Hills":"IN.ML.JH",
"Ri Bhoi":"IN.ML.RB",
"South Garo Hills":"IN.ML.SG",
"West Garo Hills":"IN.ML.WG",
"West Khasi Hills":"IN.ML.WK",
"Aizawl":"IN.MZ.AI",
"Champhai":"IN.MZ.CH",
"Kolasib":"IN.MZ.KO",
"Lawngtlai":"IN.MZ.LA",
"Lunglei":"IN.MZ.LU",
"Mamit":"IN.MZ.MA",
"Saiha":"IN.MZ.SA",
"Serchhip":"IN.MZ.SE",
"Dimapur":"IN.NL.DI",
"Kiphire":"",
"Kohima":"IN.NL.KO",
"Longleng":"",
"Mokokchung":"IN.NL.MK",
"Mon":"IN.NL.MN",
"Peren":"",
"Phek":"IN.NL.PH",
"Tuensang":"IN.NL.TU",
"Wokha":"IN.NL.WO",
"Zunheboto":"IN.NL.ZU",
"Angul":"IN.OR.AN",
"Balangir":"IN.OR.BL",
"Baleswar":"IN.OR.BW",
"Bargarh":"IN.OR.BR",
"Boudh":"IN.OR.BD",
"Bhadrak":"IN.OR.BH",
"Cuttack":"IN.OR.CU",
"Debagarh":"IN.OR.DE",
"Dhenkanal":"IN.OR.DH",
"Gajapati":"IN.OR.GP",
"Ganjam":"IN.OR.GN",
"Jagatsinghapur":"IN.OR.JS",
"Jajapur":"IN.RJ.JP",
"Jharsuguda":"IN.OR.JH",
"Kalahandi":"IN.OR.KL",
"Kandhamal":"IN.OR.KN",
"Kendrapara":"IN.OR.KP",
"Kendujhar":"IN.OR.KJ",
"Khordha":"IN.OR.KH",
"Koraput":"IN.OR.KO",
"Malkangiri":"IN.OR.ML",
"Mayurbhanj":"IN.OR.MY",
"Nabarangapur":"IN.OR.NB",
"Nayagarh":"IN.OR.NY",
"Nuapada":"IN.OR.NU",
"Puri":"IN.OR.PU",
"Rayagada":"IN.OR.RA",
"Sambalpur":"IN.OR.SA",
"Sonepur":"IN.OR.SO",
"Sundargarh":"IN.OR.SU",
"":"IN.PY.KA",
"":"IN.PY.MA",
"":"IN.PY.PO",
"":"IN.PY.YA",
"Amritsar":"IN.PB.AM",
"Barnala":"",
"Bathinda":"IN.PB.BA",
"Faridkot":"IN.PB.FR",
"Fatehgarh Sahib":"IN.PB.FT",
"Ferozepur":"IN.PB.FI",
"Gurdaspur":"IN.PB.GU",
"Hoshiarpur":"IN.PB.HO",
"Jalandhar":"IN.PB.JA",
"Kapurthala":"IN.PB.KA",
"Ludhiana":"IN.PB.LU",
"Mansa":"IN.PB.MA",
"Moga":"IN.PB.MO",
"Muktsar":"IN.PB.MU",
"Nawanshahr":"IN.PB.NS",
"Patiala":"IN.PB.PA",
"Rupnagar":"IN.PB.RU",
"S.A.S Nagar":"",
"Sangrur":"IN.PB.SA",
"Tarn Taran":"",
"Ajmer":"IN.RJ.AJ",
"Alwar":"IN.RJ.AL",
"Banswara":"IN.RJ.BN",
"Baran":"IN.RJ.BR",
"Barmer":"IN.RJ.BM",
"Bharatpur":"IN.RJ.BP",
"Bhilwara":"IN.RJ.BW",
"Bikaner":"IN.RJ.BI",
"Bundi":"IN.RJ.BU",
"Chittorgarh":"IN.RJ.CT",
"Churu":"IN.RJ.CR",
"Dausa":"IN.RJ.DA",
"Dholpur":"IN.RJ.DH",
"Dungarpur":"IN.RJ.DU",
"Ganganagar":"IN.RJ.GA",
"Hanumangarh":"IN.RJ.HA",
"Jaipur":"IN.RJ.JP",
"Jaisalmer":"IN.RJ.JS",
"Jalor":"IN.RJ.JL",
"Jhalawar":"IN.RJ.JW",
"Jhunjhunu":"IN.RJ.JJ",
"Jodhpur":"IN.RJ.JO",
"Karauli":"IN.RJ.KA",
"Kota":"IN.RJ.KO",
"Nagaur":"IN.RJ.NA",
"Pali":"IN.RJ.PA",
"":"IN.UP.PR",
"Rajsamand":"IN.RJ.RA",
"Sawai Madhopur":"IN.RJ.SM",
"Sikar":"IN.RJ.SK",
"Sirohi":"IN.RJ.SR",
"Tonk":"IN.RJ.TO",
"Udaipur":"IN.RJ.UD",
"East Sikkim":"IN.SK.ES",
"North Sikkim":"IN.SK.NS",
"South Sikkim":"IN.SK.SS",
"West Sikkim":"IN.SK.WS",
"":"IN.TN.AR",
"":"IN.TN.CH",
"Coimbatore":"IN.TN.CO",
"Cuddalore":"IN.TN.CU",
"Dharmapuri":"IN.TN.DH",
"Dindigul":"IN.TN.DI",
"Erode":"IN.TN.ER",
"Kanchipuram":"IN.TN.KC",
"Kanyakumari(Nagercoil)":"IN.TN.KK",
"Karur":"IN.TN.KR",
"Krishnagiri":"",
"Madurai":"IN.TN.MA",
"Nagapattinam":"IN.TN.NG",
"Namakkal":"IN.TN.NM",
"Perambalur":"IN.TN.PE",
"Pudukkottai":"IN.TN.PU",
"Ramanathapuram":"IN.TN.RA",
"Salem":"IN.TN.SA",
"Sivaganga":"IN.TN.SI",
"Thanjavur":"IN.TN.TJ",
"Nilgiris(Udhagamandalam)":"IN.TN.NI",
"Theni":"IN.TN.TH",
"Tiruvallur":"IN.TN.TL",
"Tiruvarur":"IN.TN.TR",
"Thoothukudi":"IN.TN.TK",
"Tiruchirappalli":"IN.TN.TC",
"Tirunelveli":"IN.TN.TI",
"":"",
"Tiruvannamalai":"IN.TN.TV",
"Vellore":"IN.TN.VE",
"Villupuram":"IN.TN.VL",
"Virudhunagar":"IN.TN.VR",
"Dhalai":"IN.TR.DH",
"North Tripura":"IN.TR.NT",
"South Tripura":"IN.TR.ST",
"West Tripura":"IN.TR.WT",
"Gomati":"",
"Khowai":"",
"Sepahijala":"",
"Unakoti":"",
"Agra":"IN.UP.AG",
"Aligarh":"IN.UP.AL",
"Allahabad":"IN.UP.AH",
"Ambedkar Nagar":"IN.UP.AN",
"Auraiya":"IN.UP.AU",
"Azamgarh":"IN.UP.AZ",
"Bagpat":"IN.UP.BG",
"Bahraich":"IN.UP.BH",
"Ballia":"IN.UP.BL",
"Balrampur":"IN.UP.BP",
"Banda":"IN.UP.BN",
"Barabanki":"IN.UP.BB",
"Bareilly":"IN.UP.BR",
"Basti":"IN.UP.BS",
"Bijnor":"IN.UP.BI",
"Budaun":"IN.UP.BD",
"Bulandshahr":"IN.UP.BU",
"Chandauli":"IN.UP.CD",
"Chitrakoot":"IN.UP.CT",
"Deoria":"IN.UP.DE",
"Etah":"IN.UP.ET",
"Etawah":"IN.UP.EW",
"Faizabad":"IN.UP.FZ",
"Farrukhabad":"IN.UP.FR",
"Fatehpur":"IN.UP.FT",
"Firozabad":"IN.UP.FI",
"Gautam Buddha Nagar":"IN.UP.GB",
"Ghaziabad":"IN.UP.GZ",
"Ghazipur":"IN.UP.GP",
"Gonda":"IN.UP.GN",
"Gorakhpur":"IN.UP.GR",
"Hamirpur":"IN.HP.HA",
"Hardoi":"IN.UP.HR",
"Mahamaya Nagar(Hathras)":"IN.UP.HT",
"Jalaun":"IN.UP.JL",
"Jaunpur":"IN.UP.JU",
"Jhansi":"IN.UP.JH",
"Jyotiba Phule Nagar":"IN.UP.JP",
"Kannauj":"IN.UP.KJ",
"Kanpur Dehat":"IN.UP.KD",
"Kanpur Nagar":"IN.UP.KN",
"Kanshiram Nagar":"",
"Kaushambi":"IN.UP.KS",
"Lakhimpur Kheri":"IN.UP.KU",
"Kushinagar":"IN.UP.LK",
"Lalitpur":"IN.UP.LA",
"Lucknow":"IN.UP.LU",
"Maharajganj":"IN.UP.MG",
"Mahoba":"IN.UP.MH",
"Mainpuri":"IN.UP.MP",
"Mathura":"IN.UP.MT",
"Mau":"0",
"Meerut":"IN.UP.ME",
"Mirzapur":"IN.UP.MI",
"Moradabad":"IN.UP.MO",
"Muzaffarnagar":"IN.UP.MU",
"Pilibhit":"IN.UP.PI",
"Pratapgarh":"IN.UP.PR",
"Rae Bareli":"IN.UP.RB",
"Rampur":"IN.UP.RA",
"Saharanpur":"IN.UP.SA",
"Sant Kabir Nagar":"IN.UP.SK",
"Sant Ravidas Nagar( Bhadohi)":"IN.UP.SR",
"Shahjahanpur":"IN.UP.SJ",
"Shravasti":"IN.UP.SV",
"Siddharthnagar":"IN.UP.SN",
"Sitapur":"IN.UP.SI",
"Sonbhadra":"IN.UP.SO",
"Sultanpur":"IN.UP.SU",
"Unnao":"IN.UP.UN",
"Varanasi":"IN.UP.VA",
"Almora":"IN.UT.AL",
"Bageshwar":"IN.UT.BA",
"Chamoli":"IN.UT.CL",
"Champawat":"IN.UT.CP",
"Dehradun":"IN.UT.DD",
"Pauri(Garhwal)":"IN.UT.PG",
"Haridwar":"IN.UT.HA",
"Nainital":"IN.UT.NA",
"Pithoragarh":"IN.UT.PI",
"Rudraprayag":"IN.UT.RP",
"Tehri Garhwal":"IN.UT.TG",
"Udham Singh Nagar":"IN.UT.US",
"Uttarkashi":"IN.UT.UT",
"":"",
"Bankura":"IN.WB.BN",
"Bardhaman":"IN.WB.BR",
"Birbhum":"IN.WB.BI",
"Dakshin Dinajpur":"IN.WB.DD",
"Darjeeling":"IN.WB.DA",
"Howrah":"IN.WB.HR",
"Hooghly":"IN.WB.HG",
"Jalpaiguri":"IN.WB.JA",
"Cooch Behar":"IN.WB.KB",
"":"IN.WB.KO",
"Malda":"IN.WB.MA",
"Midnapur East":"IN.WB.ME",
"Midnapur West":"IN.WB.ME",
"Murshidabad":"IN.WB.MU",
"Nadia":"IN.WB.NA",
"North 24 Paraganas":"IN.WB.PN",
"Purulia":"IN.WB.PU",
"Siliguri":"",
"South 24 Paraganas":"IN.WB.PS",
"Uttar Dinajpur":"IN.WB.UD",



}

CODE_NAME = dict([(v, k) for k, v in NAME_CODE.items()])

# we want to limit the decimal precision of the percentage figures
# from http://stackoverflow.com/a/1733105/3189
class PrettyFloat(float):
    def __repr__(self):
        return '%.3f' % self

def pretty_floats(obj):
    if isinstance(obj, float):
        return PrettyFloat(obj)
    elif isinstance(obj, dict):
        return dict((k, pretty_floats(v)) for k, v in obj.items())
    elif isinstance(obj, (list, tuple)):
        return map(pretty_floats, obj)
    return obj


def add_data_for_cell(sheet, row, col, datadict, key):
    if sheet.cell_type(row, col) == xlrd.XL_CELL_NUMBER:
        datadict[key] = sheet.cell_value(row, col)


def process_percent_sheet(sheet, data):
    """ returns dictionary, key is country code, value is dictionary of
    year: value, or None if no data """
    col_key_mapping = [
        (6, 'indicator1_initial'),
        (7, 'indicator1_increase'),
        (8, 'indicator2_initial'),
        (9, 'indicator2_increase'),
        (10, 'indicator1_pop_current'),
        (11, 'indicator2_pop_current'),
        (12, 'indicator1_pop_universal'),
        (13, 'indicator2_pop_universal'),
        (15, '% of schools without toilet facilities'),
        (16, 'School - Without Toilet'),
        (17, 'School - Subsidy for government schools@35000 per unit - Rs'),
        (18, 'School - Subsidy for government schools@35000 per unit -Lakh Rs'),
        (19, 'Anganwadi - % of (No Suggestions) without toilet facilities'),
        (20, 'Anganwadi - Without Latrines'),
        (21, 'Anganwadi - Subsidy for Anganwadi toilets@8000 per unit - Rs'),
        (22, 'Anganwadi - Subsidy for Aaganwadi toilets@8000 per unit - Lakh Rs'),
        (23, 'CSC - Required Complexes'),
        (24, 'CSC - Subsidy for Sanitary Complex@200000 per unit - Rs'),
        (25, 'CSC - Subsidy for Sanitary Complex@200000 per unit - Lakh  Rs'),
        (26, 'IHHL - Access to a IHHL latrine (rural only as per the baseline, APL&BPL)'),
        (27, 'IHHL - latrines to be constructed under SBA (only those eligible) i.e SBA target'),
        (28, 'IHHL - Cost of meeting SBA target for IHHL -Rs'),
        (29, 'IHHL - Cost of meeting SBA target for IHHL -Lakh Rs'),
        (30, 'Total cost of SBA of SBA targets (IHHL,school, Anganwadi and CSC) -Rs'),
        (31, 'Total cost of SBA of SBA targets (IHHL,school, Anganwadi and CSC) - Lakh Rs'),
        (31, 'Total cost of SBA of SBA targets (IHHL,school, Anganwadi and CSC) - Crore Rs'),

    ]

    for curr_row in xrange(1, sheet.nrows):
        country_name = sheet.cell_value(curr_row, 0)
        if country_name in NAME_CODE and NAME_CODE[country_name]:
            country_code = NAME_CODE[country_name]
        else:
            #print "%s not found" % country_name
            continue

        if country_code not in data:
            data[country_code] = {'name': CODE_NAME[country_code]}

        for col, key in col_key_mapping:
            add_data_for_cell(sheet, curr_row, col, data[country_code], key)

    return data


def process_absolute_sheet(sheet, data):
    """ returns dictionary, key is country code, value is dictionary of
    year: value, or None if no data """
    col_key_mapping = [
        (1, 'water_pop_current'),
        (2, 'water_pop_universal'),
        (3, 'sanitation_pop_current'),
        (4, 'sanitation_pop_universal')
    ]

    for curr_row in xrange(2, sheet.nrows):
        country_name = sheet.cell_value(curr_row, 0)
        if country_name in NAME_CODE and NAME_CODE[country_name]:
            country_code = NAME_CODE[country_name]
        else:
            #print "%s not found" % country_name
            continue

        if country_code not in data:
            data[country_code] = {'name': CODE_NAME[country_code]}

        for col, key in col_key_mapping:
            add_data_for_cell(sheet, curr_row, col, data[country_code], key)

    return data


def main(argv):
   # opts = docopt(__doc__, argv[1:])

    # somaliland has the label "-99" in the map data, and no data in the
    # spreadsheets, but we still want a label.
    data = {"-99": {"name": "Z"}}

    ## Consolidating to one sheet only
    #xls2json.py [--verbose] <xlsPercentFile> <xlsAbsoluteFile>
    percent_book = xlrd.open_workbook(argv[0])#opts['<xlsPercentFile>'])
    percent_sheet = percent_book.sheet_by_index(0)
    data = process_percent_sheet(percent_sheet, data)

    #absolute_book = xlrd.open_workbook(argv[1])#opts['<xlsAbsoluteFile>'])
    #absolute_sheet = absolute_book.sheet_by_index(0)
    #data = process_absolute_sheet(absolute_sheet, data)
   # bopts[0] = "--verbose"
    # limit float precision when printed
    data = pretty_floats(data)
   # if bopts['--verbose']:
        # pretty print the javascript
    print json.dumps(data, indent=4, sort_keys=True)
   # else:
        # compressed javascript
   #     print json.dumps(data, separators=(',', ':'))
    with open("output_districts.txt", 'w') as outfile:
        json.dump(data, outfile)

	#return
#debugging
argvo = (pfile, afile)
main(argvo)


if __name__ == '__main__':
    #sys.exit(main(sys.argv))
    main(sys.argv)
